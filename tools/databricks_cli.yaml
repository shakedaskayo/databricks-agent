tools:
  - name: databricks_cli
    description: Run Databricks CLI commands
    type: bash
    alias: databricks
    content: |
      #!/bin/bash
      set -e
      # Make sure databricks CLI is installed
      if ! command -v databricks &> /dev/null
      then
          # Install databricks CLI
          curl -fsSL https://raw.githubusercontent.com/databricks/setup-cli/main/install.sh | sh
      fi

      # Run the Databricks CLI command
      databricks $@
    args:
      command:
        description: The databricks CLI command to run (example: databricks-cli command=workspace ls)
        required: true
    env:
      - "DATABRICKS_TOKEN" # Fetched from Kubiya secret (set up at https://app.kubiya.ai/configuration-hub/secrets)
      - "DATABRICKS_HOST"
